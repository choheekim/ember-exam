/**
 *
 * Get the weight for a given module name, a file path to the module defautly generated by emberjs.
 * Ember tests are consist of Acceptance, Integration, Unit, and lint tests. In general, acceptance takes
 * longest time to execute and integration, init, and others. If the test type is not identifiable from the modulePath,
 * it will default to weight = 50 (ordered after acceptance, but before integration)
 * Ember 3.3 introduces the new types of tests (Container and Rendering tests) and they will still be generated within
 * the integration & unit directory.
 *
 * @param {*} modulePath A file path to a module
 */
function getWeight(modulePath) {
    let weight = -1;
    if (modulePath.includes('/jshint/')) {
        weight = 1;
    } else if (modulePath.includes('/unit/')) {
        weight = 10;
    } else if (modulePath.includes('/integration/')) {
        weight = 20;
    } else if (modulePath.includes('/acceptance/')) {
        weight = 150;
    } else {
        weight = 50;
    }
    return weight;
}

export default function weightTestModules(modules) {
    let weightedModule = [];
    let groups = [];

    modules.forEach(function(module) {
        const moduleWeight = getWeight(module);

        if (typeof groups[moduleWeight] == 'undefined') {
            groups[moduleWeight] = [];
        }
        groups[moduleWeight].push(module);
    });

    // returns a sort list of the weights in descending order
    const sortedWeights = Object.keys(groups).sort(function(a, b){return b-a});
    sortedWeights.forEach( function(weight) {
        const sortedMoudleArr = groups[weight].sort();
        weightedModule = weightedModule.concat(sortedMoudleArr);
    });
    return weightedModule;
}